{% extends 'base.html.twig' %}

{% block title %}{{ article.title }}{% endblock %}

{% block body %}
<h1>{{ article.title }}</h1>
<p>{{ article.content }}</p>

{{ form_start(commentForm, {'action': path('article_comment', {'id': article.id})}) }}
    {{ form_widget(commentForm) }}
    <button type="submit" class="btn btn-primary">Submit Comment</button>
{{ form_end(commentForm) }}

<h2>Comments</h2>
{% for comment in article.comments %}
    {% if comment.isIsShow %}
        <div>
            <p>{{ comment.author.email }} says:</p>
            <p>{{ comment.content }}</p>
            <p>Posted on {{ comment.createdAt|date('Y-m-d H:i:s') }}</p>
            {% if is_granted('ROLE_ADMIN') %}
                <form method="post" action="{{ path('comment_delete', {'id': comment.id}) }}" style="display: inline-block;" onsubmit="return confirm('Are you sure you want to delete this comment?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comment.id) }}">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
                <a href="{{ path('comment_edit', {'id': comment.id}) }}" class="btn btn-secondary">Edit</a>
            {% endif %}
        </div>
    {% endif %}
{% else %}
    <p>No comments yet.</p>
{% endfor %}
{% endblock %}
